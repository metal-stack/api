# Code generated by generate.go. DO NOT EDIT.

import pyqwest

{{ range $name, $api := . -}}
{{ range $svc := $api.Services -}}
import metalstack.{{ $name | trimSuffix "v2" }}.v2.{{ $svc.FileName | trimSuffix ".proto" | lower }}_connect as {{ $name | trimSuffix "v2" }}_{{ $svc.FileName | trimSuffix ".proto" | lower }}_connect
{{ end }}
{{ end }}

class Client:
    def __init__(self, baseurl: str, timeout: float = 10):
        self._baseurl = baseurl

        transport = pyqwest.SyncHTTPTransport(
            http_version=pyqwest.HTTPVersion.HTTP2,
            timeout=timeout,
        )

        self._client = pyqwest.SyncClient(transport=transport)

{{ range $name, $api := . }}
    def {{ $name | lower }}(self):
        return self._{{ $name | title }}(baseurl=self._baseurl, client=self._client)
{{ end }}

{{ range $name, $api := . }}
    class _{{ $name | title }}:
        def __init__(self, baseurl: str, client: pyqwest.SyncClient = None):
            self._baseurl = baseurl
            self._client = client

{{ range $svc := $api.Services }}
        def {{ $svc.FileName | trimSuffix ".proto" | lower }}(self):
            return {{ $name | trimSuffix "v2" }}_{{ $svc.FileName | trimSuffix ".proto" | lower }}_connect.{{ $svc.Name }}ClientSync(address=self._baseurl, http_client=self._client)
{{ end }}
{{ end }}
